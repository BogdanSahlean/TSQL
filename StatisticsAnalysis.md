# StatisticsAnalysis

Stored procedure used to analyze the logical reads from the output generate by SET STATISTICS IO. STATISTICS IO generate a text that contains reads which are generated by queries: logical reads, physical reads, read ahead reads, etc. Finding queries that generate not only performance problems but could also block the execution of other queries could be the starting point. This stored procedure will parse this text and will create a ##table having for every accessed table by our queries the number of reads (logical, physical, etc.). Probably the main performance counter used to find out slow queries is logical reads. Logical reads is the number of data pages read from data cache/buffer pool: more logical reads could mean slow query usually and less is better. To capture info about logical reads, SET STATISTICS IO represents just the simplest option, but, because the output of STATISTICS IO is just text and analysis for many queries could be cumbersome, if not time consuming. The output of STATISTICS in the case of long queries could have a lot of text. Thus, finding queries with problems could be difficult. Please note that output from STATISTICS IO, could contain text generated by TIME ON.

More, this procedure is able to take the real execution plan, to extract the text of every query and then it match for every query the output from STATISTICS IO. Warning: the real execution plan and the output from STATISTICS should be from the same query execution.

## Parameters

`@statistics VARCHAR(MAX)` This parameter is the output generated by STATISTICS IO. Mandatory.

`@plan XML` Real execution plan of the same query execution. Optional.

## Behaviour

Calling StatisticsAnalysis stored procedure will generate a new temp table `##sttcslgc`. From this point, the end user could do with this table any action for analysis.

## Execution

`EXEC StatisticsAnalysis @statistics` 

`EXEC StatisticsAnalysis @statistics, @plan`
